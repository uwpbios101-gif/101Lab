<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microscope Mastery Hub - Complete Learning System</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        /* ==============================
           1. Header CSS from Indexpage.html 
           ============================== */
        :root {
            /* Header Variables */
            --parkside-green: #016836;
            --near-black: #212721;
            --warm-grey: #54534A;
            --cool-grey: #DBD9D6;
            --goldenrod: #FABA31;
            --white-birch: #EFECE2;
            --white: #FFFFFF;

            /* Original Page Variables */
            --primary-blue: #004b87;
            --primary-dark: #003d6b;
            --accent-gold: #ffc845;
            --accent-dark: #e6b33e;
            --success: #2e7d32;
            --error: #c62828;
            --bg-light: #f5f5f5;
            --card-shadow: 0 10px 30px rgba(0, 75, 135, 0.1);
            --transition: all 0.3s ease;
        }

        /* Header Styling */
        header {
            background: var(--parkside-green);
            border-bottom: 3px solid var(--goldenrod);
            width: 100%;
            /* Removed fixed positioning to flow naturally */
        }

        .header-inner {
            max-width: 1400px;
            margin: 0 auto;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 18px;
        }

        .nav-links a {
            color: var(--white);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            white-space: nowrap;
            font-family: "Open Sans", system-ui, sans-serif;
        }

        .nav-links a:hover {
            text-decoration: underline;
        }

        /* ==============================
           2. Original Page CSS 
           ============================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }

        /* ===== NAVIGATION BUTTONS ===== */
        .landing-nav {
            padding: 1rem 2rem;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            position: relative;
            z-index: 10;
        }

        .back-button-external {
            background: white;
            border: 2px solid var(--primary-blue);
            color: var(--primary-blue);
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            padding: 0.6rem 1.5rem;
            border-radius: 30px;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
            text-decoration: none;
        }

        .back-button-external:hover {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 8px rgba(0, 75, 135, 0.2);
        }

        /* ===== LANDING PAGE ===== */
        .hero-section {
            background: linear-gradient(rgba(0, 75, 135, 0.9), rgba(0, 59, 107, 0.9)),
                url('microoo.png');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 4rem 2rem;
            text-align: center;
            border-bottom-left-radius: 40px;
            border-bottom-right-radius: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23004b87' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.3;
            z-index: 0;
            pointer-events: none;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 900px;
            margin: 0 auto;
        }

        .hero-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .hero-content {
            text-align: center;
        }

        .microscope-icon {
            font-size: 4rem;
            margin-bottom: 0;
            display: inline-block;
            animation: float 3s ease-in-out infinite;
        }

        .hero-section h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, #ffc845, #ffffff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .hero-section p {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            opacity: 0.95;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        /* ===== MODULE SELECTION ===== */
        .modules-section {
            padding: 3rem 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-title {
            text-align: center;
            color: var(--primary-blue);
            font-size: 2.5rem;
            margin-bottom: 3rem;
            position: relative;
        }

        .section-title::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--accent-gold);
            border-radius: 2px;
        }

        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .module-card {
            background: var(--white);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            border: 2px solid transparent;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .module-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 75, 135, 0.15);
            border-color: var(--accent-gold);
        }

        .card-header {
            background: var(--primary-blue);
            color: white;
            padding: 1.5rem;
            text-align: center;
        }

        .card-header h3 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .card-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }

        .card-content {
            padding: 2rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .card-content p {
            margin-bottom: 1.5rem;
            flex-grow: 1;
        }

        .card-features {
            list-style: none;
            margin-bottom: 1.5rem;
        }

        .card-features li {
            padding: 0.5rem 0;
            padding-left: 1.8rem;
            position: relative;
        }

        .card-features li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--success);
            font-weight: bold;
        }

        .btn {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            text-decoration: none;
            display: inline-block;
            margin-top: auto;
            box-shadow: 0 4px 6px rgba(0, 75, 135, 0.2);
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 75, 135, 0.3);
        }

        .btn-accent {
            background: var(--accent-gold);
            color: var(--primary-blue);
        }

        .btn-accent:hover {
            background: var(--accent-dark);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary-blue);
            color: var(--primary-blue);
        }

        .btn-outline:hover {
            background: var(--primary-blue);
            color: white;
        }

        /* ===== APP CONTAINERS ===== */
        .app-container {
            display: none;
            padding: 2rem 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .app-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== MICROSCOPE MASTERY STYLES ===== */
        .microscope-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .microscope-header {
            background: var(--primary-blue);
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-radius: 12px 12px 0 0;
        }

        .microscope-header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .progress-container {
            background: white;
            padding: 1.5rem;
            margin: 1rem auto;
            max-width: 900px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: #ffc845;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #004b87;
            font-weight: bold;
        }

        .concept-chip {
            display: inline-block;
            background: #004b87;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            margin: 0.25rem;
            font-size: 0.9rem;
            opacity: 0.5;
        }

        .concept-chip.active {
            opacity: 1;
            font-weight: bold;
            border: 2px solid #ffc845;
        }

        .concept-chip.mastery-complete {
            background: #4caf50;
            opacity: 1;
            border: none;
        }

        .module {
            background: white;
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .module.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        .module h2 {
            color: #004b87;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
        }

        .concept-box {
            background: #f0f7ff;
            border-left: 4px solid #004b87;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .analogy-box {
            background: #fff9e6;
            border-left: 4px solid #ffc845;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .alert-box {
            background: #ffebee;
            border-left: 5px solid #d32f2f;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .interactive-demo {
            background: #f5f5f5;
            padding: 2rem;
            margin: 1.5rem 0;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .slider {
            width: 100%;
            margin: 1rem 0;
        }

        .demo-display {
            min-height: 250px;
            background: white;
            border: 2px solid #004b87;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            overflow: hidden;
            position: relative;
        }

        .question-box {
            background: white;
            border: 2px solid #004b87;
            padding: 2rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .option {
            background: #f5f5f5;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .option:hover {
            background: #e8f4ff;
            border-color: #004b87;
        }

        .option.selected {
            background: #ffc845;
            border-color: #ffc845;
        }

        .option.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
            cursor: default;
        }

        .option.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
            opacity: 0.7;
        }

        .feedback {
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #e8f5e9;
            border: 2px solid #4caf50;
            color: #2e7d32;
        }

        .feedback.incorrect {
            background: #ffebee;
            border: 2px solid #f44336;
            color: #c62828;
        }

        #magImage {
            image-rendering: pixelated;
            transition: width 0.1s;
        }

        .anabaena-filament {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1px;
            transform: rotate(-5deg);
        }

        .ana-cell {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #88c488;
            transition: all 0.3s ease;
        }

        .ana-heterocyst {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background-color: #b5dcb5;
            transition: all 0.3s ease;
        }

        .wd-simulator {
            height: 400px;
            background: linear-gradient(to bottom, #f0f0f0 0%, #e0e0e0 100%);
            position: relative;
            border-bottom: 10px solid #333;
            overflow: hidden;
        }

        .nosepiece {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 140px;
            height: 60px;
            background: #333;
            border-radius: 0 0 50% 50%;
            z-index: 5;
        }

        .objective-lens {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            background: linear-gradient(90deg, #999, #eee, #999);
            border: 1px solid #666;
            border-radius: 0 0 4px 4px;
            transition: height 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
            z-index: 4;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .color-band {
            width: 100%;
            height: 8px;
            margin-bottom: 10px;
        }

        .microscope-slide {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 220px;
            height: 8px;
            background: rgba(200, 230, 255, 0.8);
            border: 1px solid #888;
            z-index: 2;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .specimen {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 15px;
            background: radial-gradient(circle at 30% 30%, #ff7777, #aa0000);
            border-radius: 50px 50px 0 0;
            z-index: 3;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }

        .measurement-arrow {
            position: absolute;
            right: 20%;
            bottom: 10px;
            width: 2px;
            background: #d32f2f;
            transition: height 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .measurement-arrow::before,
        .measurement-arrow::after {
            content: '';
            position: absolute;
            width: 10px;
            height: 2px;
            background: #d32f2f;
            left: -4px;
        }

        .measurement-arrow::before {
            top: 0;
        }

        .measurement-arrow::after {
            bottom: 0;
        }

        .measurement-label {
            position: absolute;
            right: -130px;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            padding: 2px 6px;
            border: 1px solid #d32f2f;
            color: #d32f2f;
            font-weight: bold;
            border-radius: 4px;
            font-size: 0.9rem;
            width: 120px;
        }

        .lens-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .lens-btn {
            padding: 10px 20px;
            border: 2px solid #ccc;
            background: white;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .lens-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .lens-btn.active {
            border-color: #004b87;
            background: #e3f2fd;
            color: #004b87;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }

        .dot-red {
            background: #ff4444;
        }

        .dot-yellow {
            background: #ffeb3b;
        }

        .dot-blue {
            background: #2196f3;
        }

        .dot-white {
            background: #ffffff;
            border: 1px solid #ccc;
        }

        .image-comparison {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .comparison-item {
            flex: 1;
            min-width: 200px;
            text-align: center;
        }

        /* ===== FIELD DIAMETER MASTERY STYLES ===== */
        .field-diameter-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .fd-header {
            background: var(--primary-blue);
            color: var(--white);
            padding: 2rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            border-radius: 12px 12px 0 0;
        }

        .fd-header h1 {
            margin-bottom: 0.5rem;
        }

        .fd-card {
            background: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
            border-left: 5px solid var(--primary-blue);
            transition: transform 0.2s;
        }

        .fd-card.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        .fd-hidden {
            display: none;
        }

        .fd-progress-container {
            position: sticky;
            top: 0;
            background: var(--white);
            z-index: 100;
            padding: 1rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
        }

        .fd-progress-track {
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            max-width: 900px;
            margin: 0 auto;
        }

        .fd-progress-fill {
            height: 100%;
            background: var(--accent-gold);
            width: 0%;
            transition: width 0.5s ease;
        }

        .fd-status-text {
            text-align: center;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            color: var(--primary-blue);
            font-weight: bold;
        }

        .fd-btn {
            background: var(--primary-blue);
            color: var(--white);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s;
            margin-top: 1rem;
        }

        .fd-btn:hover {
            background: var(--primary-dark);
        }

        .fd-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .fd-feedback-box {
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 4px;
            display: none;
        }

        .fd-feedback-box.correct {
            background: #e8f5e9;
            color: var(--success);
            border: 1px solid var(--success);
        }

        .fd-feedback-box.incorrect {
            background: #ffebee;
            color: var(--error);
            border: 1px solid var(--error);
        }

        .formula-container {
            font-family: 'Times New Roman', Times, serif;
            font-size: 1.3rem;
            background: #f9f9f9;
            padding: 1rem;
            border: 1px solid #ccc;
            text-align: center;
            margin: 1rem 0;
            border-radius: 8px;
        }

        .fraction {
            display: inline-block;
            vertical-align: middle;
            text-align: center;
            margin: 0 0.2rem;
        }

        .fraction>span {
            display: block;
            padding: 0.1rem;
        }

        .fraction span.numerator {
            border-bottom: 2px solid #000;
        }

        .fraction span.denominator {
            border-top: 0;
        }

        .math-symbol {
            font-size: 1.5rem;
            vertical-align: middle;
        }

        .formula-builder {
            background: #e3f2fd;
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px dashed #004b87;
            text-align: center;
        }

        .scope-view {
            width: 300px;
            height: 300px;
            background: #fff;
            border: 15px solid #333;
            border-radius: 50%;
            margin: 1rem auto;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fov-circle {
            width: 350px;
            height: 350px;
            border: 3px solid #b0c4de;
            border-radius: 50%;
            background: white;
            position: relative;
            margin: 0 auto;
            overflow: hidden;
        }

        .fov-guideline {
            position: absolute;
            width: 100%;
            top: 50%;
            border-top: 1px dashed #ccc;
        }

        .ruler-scale {
            position: absolute;
            height: 60px;
            background-image:
                repeating-linear-gradient(90deg, black 0, black 1px, transparent 1px, transparent 10%),
                repeating-linear-gradient(90deg, black 0, black 1px, transparent 1px, transparent 2%);
            background-size: 100% 100%, 100% 50%;
            background-repeat: no-repeat;
            background-position: bottom;
            border-bottom: 2px solid black;
            top: 55%;
            left: 0px;
            width: 108.7%;
        }

        .ruler-number {
            position: absolute;
            bottom: 5px;
            font-size: 14px;
            font-weight: bold;
        }

        #certificate-area {
            border: 10px double var(--primary-blue);
            padding: 3rem;
            text-align: center;
            background: #fff;
        }

        .cert-title {
            font-size: 2.5rem;
            color: var(--primary-blue);
            font-family: serif;
            margin-bottom: 1rem;
        }

        @media print {
            body * {
                visibility: hidden;
            }

            #certificate-area,
            #certificate-area * {
                visibility: visible;
            }

            #certificate-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                margin: 0;
                border: 5px double #000;
            }
        }

        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        /* ===== MAGNIFICATION MASTERY STYLES (THEME UPDATED) ===== */
        .magnification-mastery-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .mag-card {
            background: var(--white);
            border: 2px solid transparent;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            transition: var(--transition);
        }

        .mag-header {
            background: var(--primary-blue);
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-radius: 12px 12px 0 0;
            margin-bottom: 2rem;
        }

        .mag-header h2 {
            margin: 0 0 0.5rem 0;
            font-size: 2rem;
            color: white;
        }

        .mag-header p {
            margin: 0 auto;
            max-width: 600px;
            color: rgba(255, 255, 255, 0.9);
        }

        .mag-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .mag-h2 {
            margin-top: 0;
            margin-bottom: 1rem;
            font-size: 1.5rem;
            color: var(--primary-blue);
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
        }

        .mag-formula {
            background: #f0f7ff;
            border-left: 4px solid var(--primary-blue);
            padding: 1rem;
            border-radius: 4px;
            color: #333;
            font-family: 'Segoe UI', monospace;
            margin-bottom: 0.5rem;
            font-weight: bold;
            text-align: center;
        }

        .mag-label {
            display: block;
            margin: 0.5rem 0 0.25rem;
            color: #333;
            font-weight: 600;
        }

        .mag-input,
        .mag-select {
            width: 100%;
            padding: 0.8rem;
            border-radius: 4px;
            border: 1px solid #ccc;
            background: #fff;
            color: #333;
            outline: none;
            font-size: 1rem;
        }

        .mag-input:focus,
        .mag-select:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(0, 75, 135, 0.2);
        }

        .mag-button {
            cursor: pointer;
            background: var(--primary-blue);
            border: none;
            padding: 1rem;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            transition: var(--transition);
            margin-top: 1rem;
            width: 100%;
        }

        .mag-button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .mag-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            align-items: start;
        }

        .mag-result {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            background: #f5f5f5;
            border: 1px solid #ddd;
            color: #333;
            text-align: center;
        }

        .mag-hint {
            color: #666 !important;
            font-size: 0.95rem;
            font-style: italic;
            margin-top: 0.5rem;
        }

        .mag-feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 4px;
        }

        .mag-pill {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            background: var(--primary-blue);
            color: white !important;
            font-size: 0.85rem;
            font-weight: bold;
        }

        .mag-list {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
            color: #333;
        }

        .mag-list li {
            margin: 0.5rem 0;
        }

        .mag-kbd {
            font-family: monospace;
            background: #eee;
            border: 1px solid #ccc;
            padding: 0.1rem 0.4rem;
            border-radius: 4px;
            color: #333;
        }

        .mag-mastery {
            display: grid;
            gap: 1rem;
            margin-top: 1rem;
        }

        .mag-progress {
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .mag-bar {
            height: 100%;
            background: var(--success);
            width: 0%;
            transition: width 0.3s ease;
        }

        .mag-tiny {
            font-size: 0.85rem;
            color: #666 !important;
        }

        .mag-good {
            color: var(--success) !important;
            font-weight: bold;
        }

        .mag-bad {
            color: var(--error) !important;
            font-weight: bold;
        }

        .mag-warn {
            color: #e65100 !important;
            font-weight: bold;
        }

        /* ===== FOOTER ===== */
        .footer {
            background: var(--primary-blue);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
            border-top-left-radius: 40px;
            border-top-right-radius: 40px;
        }

        .footer p {
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto 1rem;
        }

        .back-to-home {
            display: inline-block;
            margin-top: 1rem;
            color: var(--accent-gold);
            text-decoration: none;
            font-weight: bold;
            transition: var(--transition);
        }

        .back-to-home:hover {
            color: white;
            text-decoration: underline;
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .hero-section h1 {
                font-size: 2.5rem;
            }

            .hero-section {
                padding: 3rem 1rem;
            }

            .modules-grid {
                grid-template-columns: 1fr;
            }

            .section-title {
                font-size: 2rem;
            }

            .microscope-icon {
                font-size: 3rem;
            }

            .mag-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="header-inner nav-links">
            <a href="../../Index.html">Week 1</a>
            <a href="../prelab/prelabreadings.html">Prelab Readings</a>
            <a href="MicroscopeMastery.html">Microscopy</a>
            <a href="../prelab/traintrack.html">Metric Conversion Practice</a>
            <a href="../prelab/traintrackhomework.html">Metric Conversion Homework</a>
            <a href="../prelab/size.html">Size Practice</a>
        </div>
    </header>

    <canvas id="confetti-canvas"></canvas>

    <div id="landing-page">
        <div class="landing-nav">
            <button class="back-button-external" onclick="exitToExternal()">
                ‚Üê Back to Lab Index
            </button>
        </div>

        <section class="hero-section">
            <div class="hero-row">
                <span class="microscope-icon">üî¨</span>
                <div class="hero-content">
                    <h1>Microscope Mastery Hub</h1>
                    <p>Your comprehensive guide to mastering microscope concepts through interactive learning,
                        simulations, and hands-on practice.</p>
                    <button class="btn btn-accent" onclick="scrollToModules()">Start Learning</button>
                </div>
            </div>

        </section>

        <section class="modules-section">
            <h2 class="section-title">Choose Your Learning Path</h2>
            <div class="modules-grid">
                <div class="module-card">
                    <div class="card-header">
                        <span class="card-icon">üìê</span>
                        <h3>Microscope Set Up</h3>
                        <p>Interactive Video Demo</p>
                    </div>
                    <div class="card-content">
                        <p>Master the correct setup, use, troubleshooting, and shutdown of a compound light microscope.
                        </p>
                        <ul class="card-features">
                            <li>Safe handling</li>
                            <li>Proper setup</li>
                            <li>Accurate focusing</li>
                            <li>Objective switching</li>
                            <li>Basic troubleshooting</li>
                            <li>Proper cleanup</li>
                        </ul>
                        <a href="Microscope_Setup.html" class="btn" target="_blank">Launch the Video Demo</a>
                    </div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <span class="card-icon">üìê</span>
                        <h3>Microscope Mastery</h3>
                        <p>Core Concepts & Interactive Demos</p>
                    </div>
                    <div class="card-content">
                        <p>Master the four essential microscopy concepts through interactive demonstrations, real-world
                            analogies, and spaced repetition.</p>
                        <ul class="card-features">
                            <li>Magnification & Empty Magnification</li>
                            <li>Resolution vs. Magnification</li>
                            <li>Contrast & Staining Techniques</li>
                            <li>Working Distance & Lens Safety</li>
                            <li>Interactive Simulations</li>
                            <li>Progress Tracking</li>
                        </ul>
                        <button class="btn" onclick="loadApp('microscope-mastery')">Launch Learning Module</button>
                    </div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <span class="card-icon">üîç</span>
                        <h3>Magnification Mastery</h3>
                        <p>Calculate Total Magnification</p>
                    </div>
                    <div class="card-content">
                        <p>Master the calculation of total magnification (ocular √ó objective) through interactive
                            practice and mastery checks.</p>
                        <ul class="card-features">
                            <li>Core concept explanation</li>
                            <li>Interactive calculator</li>
                            <li>Guided practice problems</li>
                            <li>Mastery check with progress tracking</li>
                            <li>Multiple ocular variations</li>
                            <li>Randomized question sets</li>
                        </ul>
                        <button class="btn" onclick="loadApp('magnification-mastery')">Launch Magnification
                            Tool</button>
                    </div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <span class="card-icon">üìè</span>
                        <h3>Field Diameter Lab</h3>
                        <p>Measure ‚Ä¢ Calculate ‚Ä¢ Estimate ‚Ä¢ Memorize</p>
                    </div>
                    <div class="card-content">
                        <p>Master microscope field diameter calculations and specimen estimation through guided lab
                            simulations. Essential for BIOS101 lab work.</p>
                        <ul class="card-features">
                            <li>Direct Measurement with 4x Lens</li>
                            <li>Field Diameter Calculations</li>
                            <li>The "Big Three" Memorization</li>
                            <li>Specimen Size Estimation</li>
                            <li>Final Mastery Exam</li>
                            <li>Printable Certificate</li>
                        </ul>
                        <button class="btn" onclick="loadApp('field-diameter-mastery')">Launch Lab Module</button>
                    </div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <span class="card-icon">üî¨</span>
                        <h3>Microscope Anatomy</h3>
                        <p>Structure & Function</p>
                    </div>
                    <div class="card-content">
                        <p>Master each anatomical part of the microscope through click and learn interactive
                            exploration.</p>
                        <ul class="card-features">
                            <li>Ocular Lens (Eyepiece)</li>
                            <li>Objective Lenses</li>
                            <li>Mechanical Stage</li>
                            <li>Coarse Adjustment Knob</li>
                            <li>Fine Adjustment Knob</li>
                            <li>Iris Diaphragm</li>
                        </ul>
                        <a href="MicroscopeAnatomy.html" class="btn" target="_blank">Launch the Anatomy Tool</a>
                    </div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <span class="card-icon">üìö</span>
                        <h3>Quick Reference Guide</h3>
                        <p>Essential Formulas & Values</p>
                    </div>
                    <div class="card-content">
                        <p>Access key formulas, microscope values, and quick tips for both learning modules in one
                            convenient reference.</p>
                        <ul class="card-features">
                            <li>Total Magnification Formula</li>
                            <li>Field Diameter Calculations</li>
                            <li>Working Distance Guidelines</li>
                            <li>Microscope Safety Tips</li>
                            <li>Common Stains & Uses</li>
                            <li>Troubleshooting Guide</li>
                        </ul>
                        <button class="btn btn-outline" onclick="showQuickReference()">View Reference Guide</button>
                    </div>
                </div>
            </div>
        </section>

        <footer class="footer">
            <p>Developed for BIOS101 Microscopy Lab ‚Ä¢ uwp.edu</p>
            <p>¬© 2026 Microscope Mastery Hub. All rights reserved.</p>
        </footer>
    </div>

    <div id="microscope-mastery-app" class="app-container">
        <div class="microscope-container">
            <div class="microscope-header">
                <h1>Microscope Mastery</h1>
                <p>Magnification ‚Ä¢ Resolution ‚Ä¢ Contrast ‚Ä¢ Working Distance</p>
            </div>
            
            <div class="progress-container">
                <h3>Your Learning Progress</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill">0%</div>
                </div>
                <div id="conceptMastery" style="text-align: center;">
                    <span class="concept-chip" id="chip-mag">Magnification</span>
                    <span class="concept-chip" id="chip-res">Resolution</span>
                    <span class="concept-chip" id="chip-con">Contrast</span>
                    <span class="concept-chip" id="chip-wd">Working Distance</span>
                </div>
            </div>

            <div class="microscope-container">
                <div class="module active" id="module-intro">
                    <h2>Welcome to Microscope Mastery!</h2>
                    <p style="font-size: 1.1rem; margin-bottom: 1rem;">This tool will guide you through four essential
                        microscopy concepts using multiple learning approaches to ensure deep understanding.</p>

                    <div class="concept-box">
                        <h3>What You'll Master:</h3>
                        <ul style="margin-left: 2rem; margin-top: 1rem;">
                            <li><strong>Magnification</strong> - How much bigger things appear</li>
                            <li><strong>Resolution</strong> - How much detail you can see</li>
                            <li><strong>Contrast</strong> - How easily you can distinguish structures</li>
                            <li><strong>Working Distance</strong> - The space between lens and slide</li>
                        </ul>
                    </div>

                    <div class="analogy-box">
                        <h3>üéØ Learning Approach</h3>
                        <p>We'll use real-world analogies, interactive demonstrations, and spaced repetition to
                            guarantee mastery. Each concept builds on the previous one.</p>
                    </div>

                    <button class="btn" onclick="startLearning()">Begin Learning Journey</button>
                </div>
                
                <div class="module" id="module-magnification">
                    <h2>üìê Concept 1: Magnification</h2>
                    <div class="concept-box">
                        <h3>Definition</h3>
                        <p><strong>Magnification</strong> is how many times larger an object appears compared to its actual size.</p>
                        <p style="margin-top: 1rem;"><strong>Formula:</strong> Total Magnification = Ocular Lens √ó Objective Lens</p>
                    </div>
                    <div class="interactive-demo">
                        <h3>Interactive Demo: Magnification & Pixelation</h3>
                        <p>Slide to increase magnification of the cheek cell below:</p>
                        <input type="range" min="10" max="100" value="10" class="slider" id="magSlider">
                        <div class="demo-display" id="magDisplay">
                            <div id="magImage" style="width: 50px; height: 50px; background-color: #ffb6c1; border-radius: 50%; border: 2px solid #ff6b6b;"></div>
                        </div>
                        <p><strong>Current Size: <span id="magValue">100</span>%</strong></p>
                    </div>
                    
                    <div class="question-box">
                        <h3>Quick Check: Understanding Magnification</h3>
                        <p><strong>If your eyepiece is 10x and your objective lens is 40x, what is the total magnification?</strong></p>
                        <div class="option" onclick="checkAnswer(this, false, 'mag1')">A) 50x (10 + 40)</div>
                        <div class="option" onclick="checkAnswer(this, true, 'mag1')">B) 400x (10 √ó 40)</div>
                        <div class="option" onclick="checkAnswer(this, false, 'mag1')">C) 30x (40 - 10)</div>
                        <div class="option" onclick="checkAnswer(this, false, 'mag1')">D) 4x (40 √∑ 10)</div>
                        <div class="feedback" id="feedback-mag1"></div>
                    </div>
                    
                    <div class="question-box">
                        <h3>Application Question</h3>
                        <p><strong>You're looking at a cell that's actually 0.01mm wide. Under 400x magnification, how wide does it appear?</strong></p>
                        <div class="option" onclick="checkAnswer(this, false, 'mag2')">A) 0.4mm</div>
                        <div class="option" onclick="checkAnswer(this, true, 'mag2')">B) 4mm</div>
                        <div class="option" onclick="checkAnswer(this, false, 'mag2')">C) 40mm</div>
                        <div class="option" onclick="checkAnswer(this, false, 'mag2')">D) 0.04mm</div>
                        <div class="feedback" id="feedback-mag2"></div>
                    </div>

                    <button class="btn" id="btn-mag" onclick="completeModule('magnification')" disabled>Continue to Resolution ‚Üí</button>
                </div>
                
                <div class="module" id="module-resolution">
                    <h2>üîç Concept 2: Resolution</h2>
                    <button class="btn" id="btn-res" onclick="completeModule('resolution')" disabled>Continue to Contrast ‚Üí</button>
                </div>
                
                <div class="module" id="module-contrast">
                    <h2>üé® Concept 3: Contrast</h2>
                    <div class="interactive-demo">
                        <h3>Interactive Demo: Visualizing <i>Anabaena</i></h3>
                        <input type="range" min="0" max="100" value="10" class="slider" id="contrastSlider">
                        <div class="demo-display" id="contrastDisplay" style="background: #ffffff;">
                            <div class="anabaena-filament" id="anabaenaStrand">
                                <div class="ana-cell"></div><div class="ana-cell"></div><div class="ana-cell"></div>
                                <div class="ana-heterocyst"></div>
                                <div class="ana-cell"></div><div class="ana-cell"></div><div class="ana-cell"></div>
                            </div>
                        </div>
                        <p><strong>Contrast Level: <span id="contrastValue">Low (Unstained)</span></strong></p>
                    </div>
                     <button class="btn" id="btn-con" onclick="completeModule('contrast')" disabled>Continue to Working Distance ‚Üí</button>
                </div>

                <div class="module" id="module-working-distance">
                    <h2>üìè Concept 4: Working Distance</h2>
                     <div class="interactive-demo">
                        <h3>Interactive Simulator: Lens Selection</h3>
                        <div class="lens-controls">
                            <button class="lens-btn" onclick="setLens(4)"><span class="dot dot-red"></span> 4x</button>
                            <button class="lens-btn" onclick="setLens(10)"><span class="dot dot-yellow"></span> 10x</button>
                            <button class="lens-btn" onclick="setLens(40)"><span class="dot dot-blue"></span> 40x</button>
                            <button class="lens-btn" onclick="setLens(100)"><span class="dot dot-white"></span> 100x</button>
                        </div>
                        <div class="demo-display wd-simulator">
                            <div class="nosepiece"></div>
                            <div class="objective-lens" id="objLens"><div class="color-band" id="lensBand"></div></div>
                            <div class="measurement-arrow" id="measureArrow"><div class="measurement-label" id="measureLabel">Gap: Large</div></div>
                            <div class="microscope-slide"><div class="specimen"></div></div>
                        </div>
                        <div class="alert-box" id="lens-warning" style="display:none; text-align: left;">
                            <strong>‚ö†Ô∏è CAUTION:</strong> The lens is extremely close to the specimen! Do not use the Coarse Focus knob here.
                        </div>
                        <p id="wd-observation" style="margin-top: 1rem; font-weight: bold;">Observation: The 4x lens is short, leaving plenty of room.</p>
                    </div>
                     <button class="btn" id="btn-wd" onclick="completeModule('working-distance')" disabled>Continue to Synthesis ‚Üí</button>
                </div>

                <div class="module" id="module-synthesis">
                    <h2>üéì Synthesis: Putting It All Together</h2>
                     <button class="btn" id="btn-syn" onclick="goToFinalAssessment()" disabled>Take Final Mastery Assessment ‚Üí</button>
                </div>
                
                <div class="module" id="module-final">
                    <h2>üéØ Final Mastery Assessment</h2>
                    <button class="btn btn-secondary" onclick="gradeFinalAssessment()">Submit Final Assessment</button>
                    <div class="feedback" id="final-feedback"></div>
                </div>

                <div class="module" id="module-results">
                    <h2>üéâ Assessment Complete!</h2>
                    <div class="mastery-score" id="finalScore">0%</div>
                    <div id="resultsContent"></div>
                    <button class="btn" onclick="restartLearning()">Start Over</button>
                </div>
            </div>
            
            <div style="text-align: center; margin: 2rem 0;">
                <button class="btn btn-outline" onclick="returnToLanding()">‚Üê Back to All Modules</button>
            </div>
        </div>
    </div>

    <div id="magnification-mastery-app" class="app-container">
        <div class="magnification-mastery-container">
            <div class="mag-header">
                <h2>Magnification Mastery</h2>
                <p>Learn, practice, and master how to calculate total magnification.</p>
            </div>
            <main style="padding: 1rem">
                <section class="mag-card">
                    <h2 class="mag-h2">1) Core Concept</h2>
                    </section>
                <section class="mag-card">
                    <h2 class="mag-h2">2) Interactive Calculator</h2>
                    <div class="mag-row">
                        <div>
                            <label class="mag-label">Ocular (√ó)</label>
                            <input class="mag-input" id="mag-ocular" type="number" value="10" />
                        </div>
                        <div>
                            <label class="mag-label">Objective (√ó)</label>
                            <select class="mag-select" id="mag-objective">
                                <option value="4">4√ó</option>
                                <option value="10" selected>10√ó</option>
                                <option value="40">40√ó</option>
                                <option value="100">100√ó</option>
                            </select>
                        </div>
                    </div>
                    <button class="mag-button" id="mag-calcBtn">Calculate</button>
                    <div class="mag-result" id="mag-calcResult"></div>
                </section>
                <section class="mag-card">
                    <h2 class="mag-h2">3) Guided Practice</h2>
                    <div class="mag-row">
                        <button class="mag-button" id="mag-checkPractice">Check Answers</button>
                    </div>
                    <div class="mag-feedback" id="mag-practiceFeedback"></div>
                </section>
                <section class="mag-card">
                     <h2 class="mag-h2">4) Mastery Check</h2>
                     <div id="mag-items" class="mag-mastery"></div>
                     <div class="mag-row">
                        <button class="mag-button" id="mag-checkMastery">Submit Answers</button>
                        <button class="mag-button" id="mag-newSet">New Question Set</button>
                    </div>
                    <div class="mag-progress"><div class="mag-bar" id="mag-bar"></div></div>
                    <div id="mag-masteryFeedback" class="mag-feedback"></div>
                </section>
            </main>
            <div style="text-align: center; margin: 2rem 0;">
                <button class="btn btn-outline" onclick="returnToLanding()">‚Üê Back to All Modules</button>
            </div>
        </div>
    </div>

    <div id="field-diameter-mastery-app" class="app-container">
         <div class="field-diameter-container">
            <div class="fd-progress-container">
                <div class="fd-progress-track"><div class="fd-progress-fill" id="fd-progressBar"></div></div>
                <div class="fd-status-text" id="fd-statusText">Lab Progress: 0%</div>
            </div>
            <div class="fd-header">
                <h1>üî¨ Microscope Field Diameter Mastery</h1>
                <p>Measure ‚Ä¢ Calculate ‚Ä¢ Estimate ‚Ä¢ Memorize</p>
            </div>
            <div class="field-diameter-container">
                <div id="fd-step-setup" class="fd-card active">
                     <h2>üëã Welcome to BIOS101 Lab</h2>
                     <input type="text" id="fd-studentName" placeholder="Name">
                     <input type="text" id="fd-labSection" placeholder="Lab Section">
                     <button class="fd-btn" onclick="fdInitLab()">Enter Lab</button>
                </div>
                <div id="fd-step-measure" class="fd-card fd-hidden">
                    <h3>Step 1: Measurement</h3>
                    <input type="number" id="fd-rawMeasurement" placeholder="Raw">
                    <input type="number" id="fd-roundedMeasurement" placeholder="Rounded">
                    <button class="fd-btn" onclick="fdSubmitMeasurement()">Submit</button>
                    <div id="fd-feedback-measure" class="fd-feedback-box"></div>
                    <button id="fd-btn-to-calc" class="fd-btn fd-hidden" onclick="fdNextStep('fd-step-calculate')">Next</button>
                 </div>
                 
                 <div id="fd-step-calculate" class="fd-card fd-hidden">
                     <button class="fd-btn" onclick="fdCheckFormula('10x')">Check Formula</button>
                     <div id="fd-feedback-formula-10x" class="fd-feedback-box"></div>
                     <div id="fd-calc-input-10x" class="fd-hidden">
                        <button class="fd-btn" onclick="fdCheckMath('10x')">Check Math</button>
                     </div>
                     <div id="fd-feedback-math-10x" class="fd-feedback-box"></div>
                     
                     <div id="fd-section-40x" class="fd-hidden">
                         <button class="fd-btn" onclick="fdCheckMath('40x')">Check Math</button>
                         <div id="fd-feedback-math-40x" class="fd-feedback-box"></div>
                     </div>
                     <button id="fd-btn-to-mem" class="fd-btn fd-hidden" onclick="fdNextStep('fd-step-memorize')">Next</button>
                 </div>

                 <div id="fd-step-memorize" class="fd-card fd-hidden">
                     <input type="number" id="fd-mem-4"><input type="number" id="fd-mem-10"><input type="number" id="fd-mem-40">
                     <button class="fd-btn" onclick="fdCheckMemorization()">Check</button>
                     <div id="fd-feedback-mem" class="fd-feedback-box"></div>
                     <button id="fd-btn-to-est" class="fd-btn fd-hidden" onclick="fdNextStep('fd-step-estimate')">Next</button>
                 </div>

                 <div id="fd-step-estimate" class="fd-card fd-hidden">
                     <button class="fd-btn" onclick="fdCheckEstFormula()">Check Formula</button>
                     <div id="fd-feedback-est-formula" class="fd-feedback-box"></div>
                     <div id="fd-est-calc-area" class="fd-hidden">
                         <input type="number" id="fd-est-ans-mm"><input type="number" id="fd-est-ans-um">
                         <button class="fd-btn" onclick="fdCheckEstMath()">Check Estimate</button>
                         <div id="fd-feedback-est-math" class="fd-feedback-box"></div>
                     </div>
                     <button id="fd-btn-to-exam" class="fd-btn fd-hidden" onclick="fdNextStep('fd-step-exam')">Go to Exam</button>
                 </div>

                 <div id="fd-step-exam" class="fd-card fd-hidden">
                     <h2>üèÜ Final Mastery Exam</h2>
                     <div id="fd-quiz-container"></div>
                     <button class="fd-btn" onclick="fdSubmitExam()">Submit Exam</button>
                     <div id="fd-exam-result" class="fd-feedback-box"></div>
                 </div>
                 
                 <div id="fd-certificate-area" class="fd-hidden">
                     <div id="fd-cert-name-display"></div>
                     <div id="fd-cert-section-display"></div>
                     <div id="fd-cert-date"></div>
                 </div>
                 <div id="fd-print-controls" class="fd-hidden">
                     <button class="fd-btn" onclick="window.print()">Print / Save PDF</button>
                 </div>
            </div>
            <div style="text-align: center; margin: 2rem 0;">
                <button class="btn btn-outline" onclick="returnToLanding()">‚Üê Back to All Modules</button>
            </div>
         </div>
    </div>

    <div id="quick-reference-app" class="app-container">
        <div style="max-width: 900px; margin: 0 auto; background: white; padding: 2rem; border-radius: 12px; box-shadow: var(--card-shadow);">
            <h2 style="color: var(--primary-blue); margin-bottom: 2rem; text-align: center;">Microscope Mastery Quick Reference</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem;">
                <div class="concept-box"><h3>üìê Magnification</h3><p>Total = Ocular √ó Objective</p></div>
                <div class="concept-box"><h3>üéØ Field Diameter</h3><p>4x: 5mm | 10x: 2mm | 40x: 0.5mm</p></div>
                </div>
            <div style="text-align: center; margin-top: 2rem;">
                <button class="btn" onclick="returnToLanding()">Back to Modules</button>
            </div>
        </div>
    </div>

    <script>
        // ===== LANDING PAGE FUNCTIONS =====
        function scrollToModules() {
            document.querySelector('.modules-section').scrollIntoView({
                behavior: 'smooth'
            });
        }

        // Logic for loading specific game apps
        function loadApp(appName) {
            // Hide landing page
            document.getElementById('landing-page').style.display = 'none';

            // Hide all other apps
            document.getElementById('microscope-mastery-app').classList.remove('active');
            document.getElementById('magnification-mastery-app').classList.remove('active');
            document.getElementById('field-diameter-mastery-app').classList.remove('active');
            document.getElementById('quick-reference-app').classList.remove('active');

            // Show selected app
            const app = document.getElementById(appName + '-app');
            if (app) {
                app.classList.add('active');
                window.scrollTo(0, 0);
            }
        }

        function showQuickReference() {
            loadApp('quick-reference');
        }

        // Logic for switching view back to the Landing Page
        function returnToLanding() {
            // Hide all apps
            document.querySelectorAll('.app-container').forEach(app => {
                app.classList.remove('active');
            });

            // Show landing page
            document.getElementById('landing-page').style.display = 'block';
            window.scrollTo(0, 0);
        }

        // Logic for the Landing Page "Back" button to go to external URL
        function exitToExternal() {
            window.location.href = '../index.html'; // Adjusted path
        }

        // ===== MICROSCOPE MASTERY FUNCTIONS =====
        const learningState = {
            questionsAnswered: {
                mag1: false, mag2: false,
                res1: false, res2: false,
                con1: false, con2: false,
                wd1: false,
                syn1: false, syn2: false
            },
            finalAnswers: {}
        };

        // --- MAGNIFICATION LOGIC ---
        const magSlider = document.getElementById('magSlider');
        const magImage = document.getElementById('magImage');
        const magValue = document.getElementById('magValue');
        if (magSlider) {
            magSlider.addEventListener('input', function () {
                const value = this.value;
                const newWidth = value * 5;
                if (magImage) magImage.style.width = newWidth + 'px';
                if (magValue) magValue.textContent = value + '0';
            });
        }

        // --- CONTRAST LOGIC ---
        const contrastSlider = document.getElementById('contrastSlider');
        const contrastValue = document.getElementById('contrastValue');
        const anaCells = document.querySelectorAll('.ana-cell');
        const anaHeterocysts = document.querySelectorAll('.ana-heterocyst');

        if (contrastSlider) {
            contrastSlider.addEventListener('input', function () {
                const value = parseInt(this.value);
                let opacity, colorVeg, colorHet;
                if (value < 30) {
                    contrastValue.textContent = 'Low (Unstained/Transparent)';
                    opacity = 0.1 + (value / 100);
                    colorVeg = `rgba(136, 196, 136, ${opacity})`;
                    colorHet = `rgba(181, 220, 181, ${opacity})`;
                } else if (value < 70) {
                    contrastValue.textContent = 'Medium';
                    opacity = 0.4 + (value / 200);
                    colorVeg = `rgba(100, 180, 100, ${opacity})`;
                    colorHet = `rgba(150, 210, 150, ${opacity})`;
                } else {
                    contrastValue.textContent = 'High (Stained)';
                    opacity = 1;
                    colorVeg = '#2e7d32';
                    colorHet = '#81c784';
                }
                anaCells.forEach(cell => { cell.style.backgroundColor = colorVeg; });
                anaHeterocysts.forEach(het => { het.style.backgroundColor = colorHet; });
            });
            contrastSlider.dispatchEvent(new Event('input'));
        }

        // --- WORKING DISTANCE LOGIC ---
        function setLens(mag) {
            const lens = document.getElementById('objLens');
            const band = document.getElementById('lensBand');
            const arrow = document.getElementById('measureArrow');
            const label = document.getElementById('measureLabel');
            const obs = document.getElementById('wd-observation');
            const warning = document.getElementById('lens-warning');

            if (!lens || !band || !arrow || !label || !obs || !warning) return;

            document.querySelectorAll('.lens-btn').forEach(b => b.classList.remove('active'));
            if (event && event.currentTarget) event.currentTarget.classList.add('active');

            let lensHeight, gapHeight, color, text;

            switch (mag) {
                case 4:
                    lensHeight = 100; gapHeight = 247; color = '#ff4444';
                    text = "4x Lens: Short lens. Large
